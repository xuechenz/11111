ticker_list = ['TTD.US', 'AAPL.US', 'TSLA.US']  # 举例
start_date = dt.datetime(2018, 8, 1)
end_date = dt.datetime(2023, 8, 1)

output = []

for ticker in ticker_list:
    for date in pd.date_range(start=start_date, end=end_date, freq='B'):
        try:
            price = get_spot_TED(ticker, date)
            output.append({
                'Ticker': ticker,
                'Date': date.strftime('%Y-%m-%d'),
                'Price': price
            })
        except:
            print(f"Missing data for {ticker} on {date.strftime('%Y-%m-%d')}")

df = pd.DataFrame(output)
df.to_csv('TD_spot_history.csv', index=False)


